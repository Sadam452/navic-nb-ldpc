
#ifndef CHANNEL_H_INCLUDED
#define CHANNEL_H_INCLUDED

/*!
 * \file channel.h
 * \brief header for channel functions
 */

#include "./struct.h"
#include "./init.h"

#define SQR(A) ((A)*(A))   
#define BPSK(x) (1-2*(x))  // modulation BPSK
#define PI 3.1415926536

void ModelChannel_AWGN_BPSK (code_t *code, decoder_t *decoder, table_t *table,  int **NBIN, float EbN, int *init_rand);


// optimized at 5dB
static const float table_64APSK_EB[64][2]=
{
{-1.44517484293900, 0.869265990361471},
{0.608517374206025, 0.641773215568668},
{0.630407890990280, 0.650388816334138},
{-0.0287761636372731, -0.913991564638438},
{0.106658170981804, 0.0832700857442685},
{0.951179715297979, 0.0696660604835846},
{-0.810392542553666, 1.47635054980108},
{-0.202504657906121, -0.246487359235016},
{0.499039097518182, -0.749660142920928},
{-0.362372661957218, 0.122357574379146},
{0.105790674524119, -0.792975712835332},
{-0.879709597377860, 0.303567611220836},
{-0.196148504671712, 0.122896905978182},
{0.792411411245168, -0.204033237959573},
{1.68157652241557, -0.0338473119138394},
{0.519073780781297, -0.752507950484932},
{0.869265990361471, 1.44517484293900},
{0.641773215568668, -0.608517374206025},
{0.650388816334138, -0.630407890990280},
{-0.913991564638438, 0.0287761636372731},
{0.0832700857442685, -0.106658170981804},
{0.0696660604835846, -0.951179715297979},
{1.47635054980108, 0.810392542553666},
{-0.246487359235016, 0.202504657906121},
{-0.749660142920928, -0.499039097518182},
{0.122357574379146, 0.362372661957218},
{-0.792975712835332, -0.105790674524119},
{0.303567611220836, 0.879709597377860},
{0.122896905978182, 0.196148504671712},
{-0.204033237959573, -0.792411411245168},
{-0.0338473119138394, -1.68157652241557},
{-0.752507950484932, -0.519073780781297},
{1.44517484293900, -0.869265990361471},
{-0.608517374206025, -0.641773215568668},
{-0.630407890990280, -0.650388816334138},
{0.0287761636372731, 0.913991564638438},
{-0.106658170981804, -0.0832700857442685},
{-0.951179715297979, -0.0696660604835846},
{0.810392542553666, -1.47635054980108},
{0.202504657906121, 0.246487359235016},
{-0.499039097518182, 0.749660142920928},
{0.362372661957218, -0.122357574379146},
{-0.105790674524119, 0.792975712835332},
{0.879709597377860, -0.303567611220836},
{0.196148504671712, -0.122896905978182},
{-0.792411411245168, 0.204033237959573},
{-1.68157652241557, 0.0338473119138394},
{-0.519073780781297, 0.752507950484932},
{-0.869265990361471, -1.44517484293900},
{-0.641773215568668, 0.608517374206025},
{-0.650388816334138, 0.630407890990280},
{0.913991564638438, -0.0287761636372731},
{-0.0832700857442685, 0.106658170981804},
{-0.0696660604835846, 0.951179715297979},
{-1.47635054980108, -0.810392542553666},
{0.246487359235016, -0.202504657906121},
{0.749660142920928, 0.499039097518182},
{-0.122357574379146, -0.362372661957218},
{0.792975712835332, 0.105790674524119},
{-0.303567611220836, -0.879709597377860},
{-0.122896905978182, -0.196148504671712},
{0.204033237959573, 0.792411411245168},
{0.0338473119138394, 1.68157652241557},
{0.752507950484932, 0.519073780781297}
};


static const float table_8PSK[8][2]=
{
{cos(PI*1/4), sin(PI*1/4)},
{cos(PI*2/4), sin(PI*2/4)},
{cos(PI*3/4), sin(PI*3/4)},
{cos(PI*4/4), sin(PI*4/4)},
{cos(PI*5/4 ), sin(PI*5/4 )},
{cos(PI*6/4 ), sin(PI*6/4 )},
{cos(PI*7/4 ), sin(PI*7/4 )},
{cos(PI*8/4 ), sin(PI*8/4 )}
};

#endif
